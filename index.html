<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + TS</title>
    <style>
    body {
      margin: 0;
      background-color: #1e1e1e;
      overflow: hidden;
      font-family: 'Georgia', serif;
    }

    #hud {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 160px;
      background: url('https://i.imgur.com/UbaOpJ1.jpg') repeat-x;
      border-top: 4px solid #5a3f2e;
      display: flex;
      color: #dcd6c9;
    }

    #mini-map {
      width: 180px;
      height: 100%;
      background: #2d2d2d;
      border-right: 2px solid #444;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    #build-menu {
      flex: 1;
      display: flex;
      flex-wrap: wrap;
      padding: 10px;
      gap: 8px;
      justify-content: center;
      align-content: flex-start;
    }

    .build-button {
      width: 60px;
      height: 60px;
      background-color: #645a48;
      border: 2px inset #4b4233;
      cursor: pointer;
      background-image: linear-gradient(to bottom, #6f654f, #433d32);
      color: #fff;
      font-size: 10px;
      text-align: center;
      line-height: 60px;
      transition: transform 0.1s ease-in-out;
    }

    .build-button:hover {
      transform: scale(1.05);
      border-color: #ffe58f;
    }

    #info-panel {
      width: 200px;
      background: rgba(10, 10, 10, 0.6);
      padding: 10px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      font-size: 14px;
      border-left: 2px solid #444;
    }

    .info-block {
      margin-bottom: 8px;
    }

    .graph-placeholder {
      width: 100%;
      height: 60px;
      background: #333;
      border: 1px solid #666;
    }
  </style>

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
   
<style>
        /* Global styles for the body and font */
        body {
            margin: 0;
            overflow: hidden; /* Prevent scrollbars from appearing */
            background-color: #2c2c2c; /* Dark background for the game world to contrast with HUD */
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased; /* Improve font rendering on macOS */
            -moz-osx-font-smoothing: grayscale; /* Improve font rendering on macOS */
        }

        /* Custom stone texture and styling */
        .stone-texture {
            background-color: #5a5a5a; /* Base stone color (dark gray) */
            /* Multiple linear gradients to create a subtle, chiseled stone pattern */
            background-image:
                linear-gradient(rgba(0, 0, 0, 0.2) 1px, transparent 1px), /* Dark horizontal lines */
                linear-gradient(90deg, rgba(0, 0, 0, 0.2) 1px, transparent 1px), /* Dark vertical lines */
                linear-gradient(rgba(255, 255, 255, 0.08) 1px, transparent 1px), /* Light horizontal highlights */
                linear-gradient(90deg, rgba(255, 255, 255, 0.08) 1px, transparent 1px); /* Light vertical highlights */
            background-size: 12px 12px, 12px 12px, 6px 6px, 6px 6px; /* Define pattern size */
            background-position: 0 0, 0 0, 3px 3px, 3px 3px; /* Offset for secondary pattern to create depth */
            border: 2px solid #3a3a3a; /* Darker border for definition */
            /* Inset shadow for depth, and outer shadow for lift */
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.7), 0 6px 10px rgba(0, 0, 0, 0.4);
            color: #e0e0e0; /* Light text color for readability on dark stone */
        }

        /* Custom parchment texture and styling for buttons */
        .parchment-texture {
            background-color: #e0d8b0; /* Base parchment color (light beige) */
            /* Radial gradient for subtle texture, linear gradient for depth */
            background-image:
                radial-gradient(ellipse at center, rgba(255, 255, 255, 0.1) 0%, transparent 70%),
                linear-gradient(135deg, #e0d8b0 0%, #c8c090 100%);
            border: 1px solid #a09870; /* Darker border for parchment */
            /* Inset shadow for depth, and outer shadow for lift */
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2), 2px 2px 5px rgba(0, 0, 0, 0.2);
            color: #4a4a4a; /* Dark text color for readability on light parchment */
            text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.3); /* Subtle text shadow */
            cursor: pointer; /* Indicate interactivity */
            transition: all 0.15s ease-in-out; /* Smooth transitions for hover/active states */
        }

        .parchment-texture:hover {
            filter: brightness(1.05); /* Slightly brighter on hover */
            transform: translateY(-1px); /* Slight lift effect on hover */
        }

        .parchment-texture:active {
            transform: translateY(0); /* Return to original position on click */
            box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.3); /* Deeper inset shadow for pressed effect */
        }

        /* Diamond shape for the minimap */
        #minimap-diamond {
            transform: rotate(45deg); /* Rotate the outer container by 45 degrees */
            overflow: hidden; /* Crucial to hide the corners of the square, creating the diamond shape */
            border-radius: 10px; /* Apply rounded corners to the square before rotation */
            width: 100%; /* Ensure it takes full width of its container */
            height: 100%; /* Ensure it takes full height of its container */
            display: flex; /* Use flexbox to center content */
            align-items: center;
            justify-content: center;
        }

        #minimap-diamond > div { /* Styling for the content inside the diamond */
            transform: rotate(-45deg); /* Rotate content back by -45 degrees to appear upright */
            width: 141.42%; /* sqrt(2) * 100% to ensure content fills the rotated square */
            height: 141.42%;
            position: absolute; /* Position absolutely within the rotated parent */
            top: -20.71%; /* Adjust top to center content (calculated as (100 - 141.42)/2 ) */
            left: -20.71%; /* Adjust left to center content */
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #3b423b; /* Dark green/brown background for the map area */
            border: 2px solid #4a4a4a; /* Border for the map area */
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.3); /* Inset shadow for depth */
            font-size: 1.5rem; /* Font size for the "MAP" text */
            color: #ccc; /* Light gray text color */
        }

        /* Styling for the green bar graphs in the stats panel */
        .bar-graph-container {
            width: 100%;
            height: 16px; /* Height of the bar */
            background-color: #4a4a4a; /* Darker background for the empty part of the bar */
            border-radius: 9999px; /* Fully rounded corners */
            overflow: hidden; /* Hide overflow of the fill */
            border: 1px solid #3a3a3a; /* Border for the bar container */
            box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.4); /* Inset shadow for depth */
        }

        .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%); /* Green gradient for the fill */
            border-radius: 9999px; /* Fully rounded corners */
            box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.3); /* Inset shadow for the fill */
            transition: width 0.5s ease-out; /* Smooth transition when the bar width changes */
        }

        /* Styling for the navigation buttons */
        .nav-button {
            width: 48px; /* Fixed width */
            height: 48px; /* Fixed height */
            display: flex;
            align-items: center;
            justify-content: center;
            color: #e0e0e0; /* Icon color */
            font-size: 1.5rem; /* Icon size */
            border-radius: 8px; /* Rounded corners */
            cursor: pointer; /* Indicate interactivity */
            transition: transform 0.1s ease-in-out, box-shadow 0.1s ease-in-out; /* Smooth transitions */
        }

        .nav-button:hover {
            transform: translateY(-2px); /* Slight lift on hover */
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5), 0 6px 10px rgba(0, 0, 0, 0.4); /* Enhanced shadow on hover */
        }

        .nav-button:active {
            transform: translateY(0); /* Return to original position on click */
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.6); /* Deeper inset shadow for pressed effect */
        }

        /* Specific positioning for main HUD elements */
        #minimap-container { bottom: 16px; left: 16px; width: 192px; height: 192px; } /* Bottom left */
        #notification-area { bottom: 16px; right: 16px; width: 128px; height: 128px; } /* Bottom right */

        /* Action bar with new internal layout */
        #action-bar {
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px; /* Increased padding for the larger bar */
            display: flex; /* Use flexbox for the main container */
            gap: 16px; /* Gap between the button column and the grid */
            width: 500px; /* Fixed width for desktop */
            height: 200px; /* Fixed height for desktop */
            align-items: flex-start; /* Align items to the top */
        }

        /* Stats panel positioned above and slightly left of notification area */
        #stats-panel {
            bottom: calc(16px + 128px + 16px); /* 16px (notification bottom) + 128px (notification height) + 16px (gap) */
            right: 16px; /* Align with notification area's right edge */
            width: 200px; /* Smaller width for 2x2 grid */
            padding: 12px; /* Adjusted padding */
        }

        /* Navigation buttons positioned around the bottom elements */
        /* These calculations are relative to the screen width and the action bar's fixed width */
        #nav-btn-home { bottom: 16px; left: calc(50% - 250px - 60px); } /* 250px is half of action-bar width, 60px for button + gap */
        #nav-btn-users { bottom: 88px; left: calc(50% - 250px - 60px); }
        #nav-btn-settings { bottom: 16px; right: calc(50% - 250px - 60px); }
        #nav-btn-info { bottom: 88px; right: calc(50% - 250px - 60px); }

        /* Styles for item slots in the 2x5 grid */
        .item-slot {
            width: 64px; /* Fixed width for item slots */
            height: 64px; /* Fixed height for item slots */
            background-color: #4a4a4a; /* Darker background for item slots */
            border-radius: 8px; /* Rounded corners */
            border: 1px solid #3a3a3a; /* Border for item slots */
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5); /* Inset shadow for depth */
            color: #ccc; /* Light text color */
            font-size: 0.75rem; /* Smaller font size */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.1s ease-in-out;
        }

        .item-slot:hover {
            filter: brightness(1.1);
            transform: translateY(-2px);
        }

        .item-slot:active {
            transform: translateY(0);
            box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.7);
        }

        /* Styles for minimap navigation buttons */
        .minimap-nav-button {
            width: 40px; /* Smaller than main nav buttons */
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #e0e0e0;
            font-size: 1.2rem; /* Smaller icon size */
            border-radius: 6px; /* Slightly smaller rounded corners */
            cursor: pointer;
            transition: transform 0.1s ease-in-out, box-shadow 0.1s ease-in-out;
            z-index: 10; /* Ensure they are above the map */
            /* Apply stone-texture styles */
            background-color: #5a5a5a;
            background-image:
                linear-gradient(rgba(0, 0, 0, 0.2) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 0, 0, 0.2) 1px, transparent 1px),
                linear-gradient(rgba(255, 255, 255, 0.08) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.08) 1px, transparent 1px);
            background-size: 12px 12px, 12px 12px, 6px 6px, 6px 6px;
            background-position: 0 0, 0 0, 3px 3px, 3px 3px;
            border: 2px solid #3a3a3a;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.6), 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .minimap-nav-button:hover {
            transform: translateY(-1px);
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5), 0 4px 8px rgba(0, 0, 0, 0.4);
        }

        .minimap-nav-button:active {
            transform: translateY(0);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.7);
        }

        /* Responsive adjustments for smaller screens (e.g., mobile) */
        @media (max-width: 768px) {
            /* Change main HUD elements to relative positioning for vertical stacking */
            #stats-panel, #notification-area, #minimap-container, #action-bar,
            #nav-btn-home, #nav-btn-settings, #nav-btn-users, #nav-btn-info {
                position: relative; /* Override absolute positioning */
                margin: 1rem auto; /* Center horizontally and add vertical margin */
                width: 90%; /* Take up more width on smaller screens */
                left: auto; /* Remove absolute left positioning */
                right: auto; /* Remove absolute right positioning */
                top: auto; /* Remove absolute top positioning */
                bottom: auto; /* Remove absolute bottom positioning */
                transform: none; /* Remove any transforms */
            }

            /* Adjust specific sizes for mobile */
            #notification-area {
                width: 100px; /* Smaller notification area */
                height: 100px;
            }

            #minimap-container {
                width: 140px; /* Smaller minimap */
                height: 140px;
            }

            /* Minimap buttons will naturally adjust with relative positioning of container */
            .minimap-nav-button {
                width: 32px; /* Even smaller buttons on mobile */
                height: 32px;
                font-size: 1rem;
            }

            #action-bar {
                flex-direction: column; /* Stack vertically on mobile */
                height: auto; /* Auto height for content */
                width: 90%; /* Take up more width */
                padding: 1rem; /* Adjust padding */
                gap: 1rem; /* Adjust gap */
                align-items: stretch; /* Stretch items to fill width */
            }

            #action-bar > div:first-child { /* Vertical buttons column */
                border-right: none; /* Remove vertical border */
                border-bottom: 1px solid #6a6a6a; /* Add horizontal border */
                padding-bottom: 1rem; /* Add padding below border */
                margin-bottom: 1rem; /* Add margin below border */
                flex-direction: row; /* Arrange buttons horizontally */
                flex-wrap: wrap; /* Allow buttons to wrap */
                justify-content: center; /* Center buttons */
                gap: 0.5rem; /* Smaller gap between buttons */
            }

            #action-bar > div:last-child { /* 2x5 grid for items */
                grid-template-columns: repeat(3, minmax(0, 1fr)); /* Change to 2x3 grid on mobile */
                padding-left: 0; /* Remove left padding */
                gap: 0.5rem; /* Smaller gap */
                justify-items: center; /* Center grid items */
            }

            .item-slot {
                width: 56px; /* Smaller item slots on mobile */
                height: 56px;
            }

            #stats-panel {
                width: 90%; /* Take full width on mobile */
                bottom: auto; /* Remove specific bottom positioning */
                right: auto; /* Remove specific right positioning */
            }

            /* Adjust the main HUD container for mobile to allow vertical flow */
            #hud-container {
                 position: fixed; /* Make it stick to the viewport */
                bottom: 0; /* Stick to the bottom */
                left: 0;
                width: 100vw; /* Full viewport width */
                height: 500px; /* Fixed height as requested */
                overflow: hidden; /* Hide anything that goes outside this fixed height */
            }
        }
    </style>
  </head>
  <body>
    <div id="app"></div>

  <!-- Main HUD container, full screen width and height -->
    <div id="hud-container" class="w-screen overflow-hidden">
        <!-- Bottom Left: Minimap Container -->
        <div id="minimap-container" class="absolute bottom-4 left-4">
            <!-- Top-Left Button (Zoom Out) -->
            <button id="minimap-zoom-out" class="minimap-nav-button absolute top-0 left-0">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-minus"><path d="M5 12h14"/></svg>
            </button>
            <!-- Top-Right Button (Zoom In) -->
            <button id="minimap-zoom-in" class="minimap-nav-button absolute top-0 right-0">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
            </button>

            <!-- Diamond shaped minimap with stone texture -->
            <div id="minimap-diamond" class="relative w-full h-full stone-texture">
                <!-- Content inside the diamond, rotated back to be upright -->
                <div class="absolute inset-0 flex items-center justify-center text-white text-2xl font-bold">
                    MAP
                </div>
            </div>

            <!-- Bottom-Left Button (Rotate Left) -->
            <button id="minimap-rotate-left" class="minimap-nav-button absolute bottom-0 left-0">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-ccw"><path d="M3 12a9 9 0 1 0 9-9V3"/><path d="M4.5 7.5 3 12 7.5 10.5"/></svg>
            </button>
            <!-- Bottom-Right Button (Rotate Right) -->
            <button id="minimap-rotate-right" class="minimap-nav-button absolute bottom-0 right-0">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rotate-cw"><path d="M21 12a9 9 0 1 1-9-9V3"/><path d="M19.5 6.5 21 12 16.5 10.5"/></svg>
            </button>
        </div>

        <!-- Bottom Right (below notification): Stats Panel -->
        <div id="stats-panel" class="absolute p-3 rounded-lg shadow-lg stone-texture">
            <h2 class="text-lg font-bold text-gray-200 mb-2 text-center">Stats</h2>
            <div class="grid grid-cols-2 gap-x-3 gap-y-1">
                <!-- Population Stat -->
                <div>
                    <div class="text-gray-300 text-xs mb-0.5">Pop: 1200</div>
                    <div class="bar-graph-container"><div class="bar-fill" style="width: 75%;"></div></div>
                </div>
                <!-- Gold Stat -->
                <div>
                    <div class="text-gray-300 text-xs mb-0.5">Gold: $15K</div>
                    <div class="bar-graph-container"><div class="bar-fill" style="width: 50%;"></div></div>
                </div>
                <!-- Approval Stat -->
                <div>
                    <div class="text-gray-300 text-xs mb-0.5">Apprv: 85%</div>
                    <div class="bar-graph-container"><div class="bar-fill" style="width: 85%;"></div></div>
                </div>
                <!-- Resources Stat (New) -->
                <div>
                    <div class="text-gray-300 text-xs mb-0.5">Res: 420</div>
                    <div class="bar-graph-container"><div class="bar-fill" style="width: 60%;"></div></div>
                </div>
            </div>
        </div>

        <!-- Bottom Right: Notification Area -->
        <div id="notification-area" class="absolute rounded-full shadow-lg stone-texture flex flex-col items-center justify-center text-white text-4xl">
            <!-- SVG Icon for notification (exclamation mark/bell-like) -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-12 h-12 text-yellow-300">
                <path fill-rule="evenodd" d="M5.25 9a6.002 6.002 0 0 0 6 6h.75a.75.75 0 0 1 0 1.5H12a.75.75 0 0 1-.75.75h-.75a.75.75 0 0 0 0 1.5h.75a2.25 2.25 0 0 0 2.25-2.25v-.811a.75.75 0 0 1 .102-.439l1.474-2.456a.75.75 0 0 1 .599-.294H19.5a.75.75 0 0 0 .75-.75V9A6 6 0 0 0 12 3h-.75a.75.75 0 0 0 0 1.5H12A4.5 4.5 0 0 1 16.5 9v.44l-1.92-.32a.75.75 0 0 0-.44.102L12 11.25l-2.19-.365a.75.75 0 0 0-.44-.102V9A4.5 4.5 0 0 1 12 4.5h.75a.75.75 0 0 0 0-1.5H12A6.002 6.002 0 0 0 5.25 9Z" clip-rule="evenodd" />
            </svg>
            <span class="text-xs text-gray-300 mt-0.5">New Event!</span>
        </div>

        <!-- Bottom Center: Horizontal Action Bar (Redesigned) -->
        <div id="action-bar" class="absolute p-4 rounded-lg shadow-lg stone-texture flex">
            <!-- Left Column: Vertical Buttons -->
            <div class="flex flex-col space-y-2 pr-4 border-r border-gray-600">
                <button class="parchment-texture px-4 py-2 rounded-md text-sm font-semibold whitespace-nowrap" id="build">Build</button>
                <button class="parchment-texture px-4 py-2 rounded-md text-sm font-semibold whitespace-nowrap" id="edicts">Edicts</button>
                <button class="parchment-texture px-4 py-2 rounded-md text-sm font-semibold whitespace-nowrap" id="trade">Trade</button>
                <button class="parchment-texture px-4 py-2 rounded-md text-sm font-semibold whitespace-nowrap" id="military">Military</button>
            </div>

            <!-- Right Section: 2x5 Grid for Items -->
            <div class="grid grid-cols-5 gap-2 pl-4">
                <!-- Item Slots (10 total) -->
                <div class="item-slot" id="build-house">House</div>
                <div class="item-slot" id="build-tenant">Tenant</div>
                <div class="item-slot">Item 3</div>
                <div class="item-slot">Item 4</div>
                <div class="item-slot">Item 5</div>
                <div class="item-slot">Item 6</div>
                <div class="item-slot">Item 7</div>
                <div class="item-slot">Item 8</div>
                <div class="item-slot">Item 9</div>
                <div class="item-slot">Item 10</div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <!-- Home Button -->
        <button id="nav-btn-home" class="nav-button stone-texture absolute">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-home"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        </button>
        <!-- Settings Button -->
        <button id="nav-btn-settings" class="nav-button stone-texture absolute">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-settings"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.78 1.28a2 2 0 0 0 .73 2.73l.04.02a2 2 0 0 1 .97 1.95v.44a2 2 0 0 1-.97 1.95l-.04.02a2 2 0 0 0-.73 2.73l.78 1.28a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.78-1.28a2 2 0 0 0-.73-2.73l-.04-.02a2 2 0 0 1-.97-1.95v-.44a2 2 0 0 1 .97-1.95l.04-.02a2 2 0 0 0 .73-2.73l-.78-1.28a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
        </button>
        <!-- Users Button -->
        <button id="nav-btn-users" class="nav-button stone-texture absolute">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
        </button>
        <!-- Info/Help Button -->
        <button id="nav-btn-info" class="nav-button stone-texture absolute">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
        </button>
    </div>


  <!-- main app load -->
    <script type="module" src="/src/main.ts"></script>
    
    <script id="vertexShader" type="x-shader/x-vertex">
            uniform mat4 textureMatrix;
            uniform float time;

            varying vec4 mirrorCoord;
            varying vec4 worldPosition;

            #include <common>
            #include <fog_pars_vertex>
            #include <shadowmap_pars_vertex>
            #include <logdepthbuf_pars_vertex>

            uniform vec4 waveA;
            uniform vec4 waveB;
            uniform vec4 waveC;

            vec3 GerstnerWave (vec4 wave, vec3 p) {
            	float steepness = wave.z;
            	float wavelength = wave.w;
            	float k = 2.0 * PI / wavelength;
            	float c = sqrt(9.8 / k);
            	vec2 d = normalize(wave.xy);
            	float f = k * (dot(d, p.xy) - c * time);
            	float a = steepness / k;

            	return vec3(
            		d.x * (a * cos(f)),
            		d.y * (a * cos(f)),
            		a * sin(f)
            	);
            }

            void main() {
            	mirrorCoord = modelMatrix * vec4( position, 1.0 );
            	worldPosition = mirrorCoord.xyzw;
            	mirrorCoord = textureMatrix * mirrorCoord;

            	vec3 p = position.xyz;
            	p += GerstnerWave(waveA, position.xyz);
            	p += GerstnerWave(waveB, position.xyz);
            	p += GerstnerWave(waveC, position.xyz);
            	gl_Position = projectionMatrix * modelViewMatrix * vec4( p.x, p.y, p.z, 1.0);

            	#include <beginnormal_vertex>
            	#include <defaultnormal_vertex>
            	#include <logdepthbuf_vertex>
            	#include <fog_vertex>
            	#include <shadowmap_vertex>
            }
        </script>

        <script id="fragmentShader" type="x-shader/x-fragment">
            uniform sampler2D mirrorSampler;
            uniform float alpha;
            uniform float time;
            uniform float size;
            uniform float distortionScale;
            uniform sampler2D normalSampler;
            uniform vec3 sunColor;
            uniform vec3 sunDirection;
            uniform vec3 eye;
            uniform vec3 waterColor;

            varying vec4 mirrorCoord;
            varying vec4 worldPosition;

            vec4 getNoise( vec2 uv ) {
                vec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);
                vec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );
                vec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );
                vec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );
                vec4 noise = texture2D( normalSampler, uv0 ) +
                    texture2D( normalSampler, uv1 ) +
                    texture2D( normalSampler, uv2 ) +
                    texture2D( normalSampler, uv3 );
                return noise * 0.5 - 1.0;
            }

            void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {
                vec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );
                float direction = max( 0.0, dot( eyeDirection, reflection ) );
                specularColor += pow( direction, shiny ) * sunColor * spec;
                diffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;
            }

            #include <common>
            #include <packing>
            #include <bsdfs>
            #include <fog_pars_fragment>
            #include <logdepthbuf_pars_fragment>
            #include <lights_pars_begin>
            #include <shadowmap_pars_fragment>
            #include <shadowmask_pars_fragment>

            void main() {

                #include <logdepthbuf_fragment>
                vec4 noise = getNoise( worldPosition.xz * size );
                vec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );

                vec3 diffuseLight = vec3(0.0);
                vec3 specularLight = vec3(0.0);

                vec3 worldToEye = eye-worldPosition.xyz;
                vec3 eyeDirection = normalize( worldToEye );
                sunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );

                float distance = length(worldToEye);

                vec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;
                vec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );

                float theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );
                float rf0 = 0.3;
                float reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );
                vec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;
                vec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);
                vec3 outgoingLight = albedo;
                gl_FragColor = vec4( outgoingLight, alpha );

                #include <tonemapping_fragment>
                #include <fog_fragment>
            }
        </script>
  </body>
</html>
